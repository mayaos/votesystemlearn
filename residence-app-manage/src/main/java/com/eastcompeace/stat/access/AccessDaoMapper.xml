<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace value ： 实现的DAO接口的路径 -->
<mapper namespace="com.eastcompeace.stat.access.AccessDao">
	<!-- resultMap:定义结果集中表字段与实体类属性的映射关系 -->
	<resultMap type="AccessLog" id="accessLogMap">
		<result property="citizenId" column="citizen_id"/>
		<result property="userName" column="user_name"/>
		<result property="accessFrom" column="access_from"/>
		<result property="requestUrl" column="request_url"/>
		<result property="requestTime" column="request_time"/>
	</resultMap>
	
	<select id="queryForList" parameterType="AccessLog" resultMap="accessLogMap">
		SELECT
			citizen_id,
			user_name,
			access_from,
			request_url,	
			DATE_FORMAT(request_time,'%Y-%m-%d %H:%i:%s') request_time
		FROM
			citizen_access_log
		WHERE
		 	1=1
		 	<if test="citizenId !=null and citizenId !=''">
		 		AND citizen_id LIKE CONCAT('%',#{citizenId},'%')
		 	</if>
		 	<if test="userName !=null and userName !=''">
		 		AND user_name LIKE CONCAT('%',#{userName},'%')
		 	</if>
		 	<if test="accessFrom !=null and accessFrom !=''">
		 		AND access_from = #{accessFrom}
		 	</if>
		 	<if test="requestUrl !=null and requestUrl !=''">
		 		AND request_url LIKE CONCAT('%',#{requestUrl},'%')
		 	</if>
		 	<if test="startTime !=null and startTime !='' and endTime !=null and endTime !=''">
		 		AND request_time BETWEEN #{startTime} and #{endTime}
		 	</if>
		 ORDER BY
		 	request_time DESC
	</select>
</mapper>
	
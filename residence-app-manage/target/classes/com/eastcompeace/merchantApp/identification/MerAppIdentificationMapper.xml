<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.eastcompeace.merchantApp.identification.MerAppIdentificationDao">
	<select id="listMerchatApp" resultType="com.eastcompeace.model.MerchantAppModel">
		SELECT
			id id,
			CASE from_type
			WHEN 1 THEN '微信公众号'
			WHEN 2 THEN '支付宝生活号'
			END as fromType,
			merchant_name merchantName,
			company_name companyName,
			CASE company_type
			WHEN 01 THEN '外企'
			WHEN 02 THEN '中外合资企业'
			WHEN 03 THEN '民营企业'
			WHEN 04 THEN '国企'
			WHEN 05 THEN '其他'
			END as companyType,			
			area_name division,
			address address,
			main_category mainCategory,
			contacts contacts,
			position position,
			phone phone,
			email email,	
			others others,
			license_img1 licenseImg1,
			license_img2 licenseImg2,
			license_img3 licenseImg3,
			storefront_photos1 storefrontPhotos1,
			storefront_photos2 storefrontPhotos2,
			storefront_photos3 storefrontPhotos3,
			audit_failed_msg auditFailedMsg
	    FROM
			wx_merchant_info
			LEFT JOIN conf_area ON division=area_id
		Where
			step=2
	</select>
	
	<update id="updateMerApp" parameterType="com.eastcompeace.model.MerchantAppModel">
		UPDATE wx_merchant_info				
		<trim prefix="SET" suffixOverrides=",">   
			<if test="step != null and step != ''">
				step = #{step},
			</if>
				audit_failed_msg=#{auditFailedMsg}
		</trim>
		WHERE
			id = #{id}	
	</update>
</mapper>